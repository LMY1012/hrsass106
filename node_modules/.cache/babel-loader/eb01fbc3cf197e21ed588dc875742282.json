{"remainingRequest":"C:\\Users\\陌上花开，可缓缓归归矣\\Desktop\\hrsaas\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\陌上花开，可缓缓归归矣\\Desktop\\hrsaas\\node_modules\\eslint-loader\\index.js??ref--13-0!C:\\Users\\陌上花开，可缓缓归归矣\\Desktop\\hrsaas\\src\\permission.js","dependencies":[{"path":"C:\\Users\\陌上花开，可缓缓归归矣\\Desktop\\hrsaas\\src\\permission.js","mtime":1655251573807},{"path":"C:\\Users\\陌上花开，可缓缓归归矣\\Desktop\\hrsaas\\babel.config.js","mtime":1655089325320},{"path":"C:\\Users\\陌上花开，可缓缓归归矣\\Desktop\\hrsaas\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1655089562873},{"path":"C:\\Users\\陌上花开，可缓缓归归矣\\Desktop\\hrsaas\\node_modules\\babel-loader\\lib\\index.js","mtime":1655089564691},{"path":"C:\\Users\\陌上花开，可缓缓归归矣\\Desktop\\hrsaas\\node_modules\\eslint-loader\\index.js","mtime":1655089563279}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9yZWdlbmVyYXRvclJ1bnRpbWUgZnJvbSAiQzovVXNlcnMvXHU5NjRDXHU0RTBBXHU4MkIxXHU1RjAwXHVGRjBDXHU1M0VGXHU3RjEzXHU3RjEzXHU1RjUyXHU1RjUyXHU3N0UzL0Rlc2t0b3AvaHJzYWFzL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9yZWdlbmVyYXRvclJ1bnRpbWUuanMiOwppbXBvcnQgX3RvQ29uc3VtYWJsZUFycmF5IGZyb20gIkM6L1VzZXJzL1x1OTY0Q1x1NEUwQVx1ODJCMVx1NUYwMFx1RkYwQ1x1NTNFRlx1N0YxM1x1N0YxM1x1NUY1Mlx1NUY1Mlx1NzdFMy9EZXNrdG9wL2hyc2Fhcy9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vdG9Db25zdW1hYmxlQXJyYXkuanMiOwppbXBvcnQgX2FzeW5jVG9HZW5lcmF0b3IgZnJvbSAiQzovVXNlcnMvXHU5NjRDXHU0RTBBXHU4MkIxXHU1RjAwXHVGRjBDXHU1M0VGXHU3RjEzXHU3RjEzXHU1RjUyXHU1RjUyXHU3N0UzL0Rlc2t0b3AvaHJzYWFzL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9hc3luY1RvR2VuZXJhdG9yLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuY29uY2F0LmpzIjsKLy8g6Lev55Sx55qE5oum5oiq5p2D6ZmQ6Zeu6aKYCmltcG9ydCByb3V0ZXIgZnJvbSAnQC9yb3V0ZXInOwppbXBvcnQgc3RvcmUgZnJvbSAnQC9zdG9yZSc7CmltcG9ydCBOUHJvZ3Jlc3MgZnJvbSAnbnByb2dyZXNzJzsKaW1wb3J0ICducHJvZ3Jlc3MvbnByb2dyZXNzLmNzcyc7IC8vIOW8leWFpei/m+W6puadoeagt+W8jwovLyDliY3nva7lrojljasKCnZhciB3aGlsZUxpc3QgPSBbJy9sb2dpbicsICcvNDA0J107CnJvdXRlci5iZWZvcmVFYWNoKCAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkgewogIHZhciBfcmVmID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JSdW50aW1lKCkubWFyayhmdW5jdGlvbiBfY2FsbGVlKHRvLCBmcm9tLCBuZXh0KSB7CiAgICB2YXIgX3lpZWxkJHN0b3JlJGRpc3BhdGNoLCByb2xlcywgcm91dGVzOwoKICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lKCkud3JhcChmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkgewogICAgICB3aGlsZSAoMSkgewogICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgTlByb2dyZXNzLnN0YXJ0KCk7IC8vIOW8gOWQr+i/m+W6puadoQogICAgICAgICAgICAvLyBuZXh05piv5LiA5Liq5b+F6aG75omn6KGM55qE6ZKp5a2QIOS4jeaJp+ihjOWwseWNoeS4u+S6hgoKICAgICAgICAgICAgaWYgKCFzdG9yZS5nZXR0ZXJzLnRva2VuKSB7CiAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDIxOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoISh0by5wYXRoID09PSAnL2xvZ2luJykpIHsKICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gNjsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8gbmV4dCgpIOaUvuihjAogICAgICAgICAgICAvLyBuZXh0KGZhbHNlKSDnu4jmraIKICAgICAgICAgICAgLy8gbmV4dCjlnLDlnYApIOi3s+WIsOafkOS4qiDlnLDlnYAKICAgICAgICAgICAgbmV4dCgnLycpOyAvLyDot7PliLDkuLvpobUKCiAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAxOTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSA2OgogICAgICAgICAgICBpZiAoc3RvcmUuZ2V0dGVycy51c2VySWQpIHsKICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMTg7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA5OwogICAgICAgICAgICByZXR1cm4gc3RvcmUuZGlzcGF0Y2goJ3VzZXIvZ2V0VXNlckluZm8nKTsKCiAgICAgICAgICBjYXNlIDk6CiAgICAgICAgICAgIF95aWVsZCRzdG9yZSRkaXNwYXRjaCA9IF9jb250ZXh0LnNlbnQ7CiAgICAgICAgICAgIHJvbGVzID0gX3lpZWxkJHN0b3JlJGRpc3BhdGNoLnJvbGVzOwogICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMTM7CiAgICAgICAgICAgIHJldHVybiBzdG9yZS5kaXNwYXRjaCgncGVybWlzc2lvbi9maWx0ZXJSb3V0ZXMnLCByb2xlcy5tZW51cyk7CgogICAgICAgICAgY2FzZSAxMzoKICAgICAgICAgICAgcm91dGVzID0gX2NvbnRleHQuc2VudDsKICAgICAgICAgICAgLy8g5q2k5pe25b6X5Yiw55qEcm91dGVz5piv5b2T5YmN55So5oi355qE5omA5oul5pyJ55qE55qE5Yqo5oCB6Lev55Sx55qE5p2D6ZmQCiAgICAgICAgICAgIHJvdXRlci5hZGRSb3V0ZXMoW10uY29uY2F0KF90b0NvbnN1bWFibGVBcnJheShyb3V0ZXMpLCBbewogICAgICAgICAgICAgIHBhdGg6ICcqJywKICAgICAgICAgICAgICByZWRpcmVjdDogJy80MDQnLAogICAgICAgICAgICAgIGhpZGRlbjogdHJ1ZQogICAgICAgICAgICB9XSkpOyAvLyDlsIblvZPliY3liqjmgIHot6/nlLHliqDliLDlvZPliY3ot6/nlLHop4TliJnkuIoKICAgICAgICAgICAgLy8g5YqgYXdhaXTnmoTmhI/mgJ3mmK8g5by65Yi2562J5b6F6I635Y+W5a6M55So5oi36LWE5paZ5LmL5ZCOIOaJjeWOu+aUvuihjCAg5bCx6IO95L+d6K+BIOeUqOaIt+i/m+WIsOmhtemdouaXtuWAmSDmnInotYTmlpkKICAgICAgICAgICAgLy8g5re75Yqg5a6M6Lev55Sx5LmL5ZCOIOS4jeiDveeUqG5leHQoKSAg6KaB55SobmV4dCh0by5wYXRoKSDlkKbliJnlnLDlnYDkuI3og73nlJ/mlYgg6L+Z566X5piv5LiA5Liq5bey55+lIOeahOWwj+e8uumZtwogICAgICAgICAgICAvLyDmiafooYzlroxhZGRSb3V0ZXMg5b+F6aG75omn6KGMbmV4dCh0by5wYXRoKSDkuI3og73miafooYwgbmV4dCgpIOi/meaYr+S4gOS4quW3suefpeeahOmXrumimOe8uumZtwoKICAgICAgICAgICAgbmV4dCh0by5wYXRoKTsgLy8g6Kej5Yaz55u05o6l5omn6KGMbmV4dCgp5pe255qE5byC5bi4CgogICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMTk7CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgMTg6CiAgICAgICAgICAgIG5leHQoKTsgLy8g5pS+6KGMCgogICAgICAgICAgY2FzZSAxOToKICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDIyOwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlIDIxOgogICAgICAgICAgICBpZiAod2hpbGVMaXN0LmluZGV4T2YodG8ucGF0aCkgPiAtMSkgewogICAgICAgICAgICAgIC8vIOihqOekuuWcqOeZveWQjeWNlemHjOmdogogICAgICAgICAgICAgIG5leHQoKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICBuZXh0KCcvbG9naW4nKTsKICAgICAgICAgICAgfQoKICAgICAgICAgIGNhc2UgMjI6CiAgICAgICAgICAgIE5Qcm9ncmVzcy5kb25lKCk7IC8vIOaYr+S4uuS6huino+WGs+aJi+WKqOi+k+WFpeWcsOWdgOaXtiDov5vluqbmnaHkuI3lhbPpl63nmoTpl67popgKCiAgICAgICAgICBjYXNlIDIzOgogICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sIF9jYWxsZWUpOwogIH0pKTsKCiAgcmV0dXJuIGZ1bmN0aW9uIChfeCwgX3gyLCBfeDMpIHsKICAgIHJldHVybiBfcmVmLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgfTsKfSgpKTsgLy8g5ZCO572u5a6I5Y2rCgpyb3V0ZXIuYWZ0ZXJFYWNoKGZ1bmN0aW9uICgpIHsKICBOUHJvZ3Jlc3MuZG9uZSgpOwp9KTs="},{"version":3,"names":["router","store","NProgress","whileList","beforeEach","to","from","next","start","getters","token","path","userId","dispatch","roles","menus","routes","addRoutes","redirect","hidden","indexOf","done","afterEach"],"sources":["C:/Users/陌上花开，可缓缓归归矣/Desktop/hrsaas/src/permission.js"],"sourcesContent":["// 路由的拦截权限问题\r\nimport router from '@/router'\r\nimport store from '@/store'\r\nimport NProgress from 'nprogress'\r\nimport 'nprogress/nprogress.css' // 引入进度条样式\r\n\r\n// 前置守卫\r\nconst whileList = ['/login', '/404']\r\nrouter.beforeEach(async(to, from, next) => {\r\n  NProgress.start() // 开启进度条\r\n  // next是一个必须执行的钩子 不执行就卡主了\r\n  if (store.getters.token) {\r\n    if (to.path === '/login') {\r\n      // next() 放行\r\n      // next(false) 终止\r\n      // next(地址) 跳到某个 地址\r\n      next('/') // 跳到主页\r\n    } else {\r\n      // 要判断是不是已经获取过资料了\r\n      if (!store.getters.userId) {\r\n        // 如果id不存在 意味着当前没有用户资料 就要去获取用户资料\r\n        // vuex的action是一个promise\r\n        const { roles } = await store.dispatch('user/getUserInfo')\r\n        // 此时已经获取完资料\r\n        const routes = await store.dispatch('permission/filterRoutes', roles.menus)\r\n        // 此时得到的routes是当前用户的所拥有的的动态路由的权限\r\n        router.addRoutes([...routes, { path: '*', redirect: '/404', hidden: true }]) // 将当前动态路由加到当前路由规则上\r\n        // 加await的意思是 强制等待获取完用户资料之后 才去放行  就能保证 用户进到页面时候 有资料\r\n        // 添加完路由之后 不能用next()  要用next(to.path) 否则地址不能生效 这算是一个已知 的小缺陷\r\n        // 执行完addRoutes 必须执行next(to.path) 不能执行 next() 这是一个已知的问题缺陷\r\n        next(to.path) // 解决直接执行next()时的异常\r\n      } else {\r\n        next() // 放行\r\n      }\r\n    }\r\n  } else {\r\n    if (whileList.indexOf(to.path) > -1) {\r\n      // 表示在白名单里面\r\n      next()\r\n    } else {\r\n      next('/login')\r\n    }\r\n  }\r\n  NProgress.done() // 是为了解决手动输入地址时 进度条不关闭的问题\r\n})\r\n\r\n// 后置守卫\r\nrouter.afterEach(() => {\r\n  NProgress.done()\r\n})\r\n"],"mappings":";;;;AAAA;AACA,OAAOA,MAAP,MAAmB,UAAnB;AACA,OAAOC,KAAP,MAAkB,SAAlB;AACA,OAAOC,SAAP,MAAsB,WAAtB;AACA,OAAO,yBAAP,C,CAAiC;AAEjC;;AACA,IAAMC,SAAS,GAAG,CAAC,QAAD,EAAW,MAAX,CAAlB;AACAH,MAAM,CAACI,UAAP;EAAA,sEAAkB,iBAAMC,EAAN,EAAUC,IAAV,EAAgBC,IAAhB;IAAA;;IAAA;MAAA;QAAA;UAAA;YAChBL,SAAS,CAACM,KAAV,GADgB,CACE;YAClB;;YAFgB,KAGZP,KAAK,CAACQ,OAAN,CAAcC,KAHF;cAAA;cAAA;YAAA;;YAAA,MAIVL,EAAE,CAACM,IAAH,KAAY,QAJF;cAAA;cAAA;YAAA;;YAKZ;YACA;YACA;YACAJ,IAAI,CAAC,GAAD,CAAJ,CARY,CAQF;;YARE;YAAA;;UAAA;YAAA,IAWPN,KAAK,CAACQ,OAAN,CAAcG,MAXP;cAAA;cAAA;YAAA;;YAAA;YAAA,OAccX,KAAK,CAACY,QAAN,CAAe,kBAAf,CAdd;;UAAA;YAAA;YAcFC,KAdE,yBAcFA,KAdE;YAAA;YAAA,OAgBWb,KAAK,CAACY,QAAN,CAAe,yBAAf,EAA0CC,KAAK,CAACC,KAAhD,CAhBX;;UAAA;YAgBJC,MAhBI;YAiBV;YACAhB,MAAM,CAACiB,SAAP,8BAAqBD,MAArB,IAA6B;cAAEL,IAAI,EAAE,GAAR;cAAaO,QAAQ,EAAE,MAAvB;cAA+BC,MAAM,EAAE;YAAvC,CAA7B,IAlBU,CAkBmE;YAC7E;YACA;YACA;;YACAZ,IAAI,CAACF,EAAE,CAACM,IAAJ,CAAJ,CAtBU,CAsBI;;YAtBJ;YAAA;;UAAA;YAwBVJ,IAAI,GAxBM,CAwBH;;UAxBG;YAAA;YAAA;;UAAA;YA4Bd,IAAIJ,SAAS,CAACiB,OAAV,CAAkBf,EAAE,CAACM,IAArB,IAA6B,CAAC,CAAlC,EAAqC;cACnC;cACAJ,IAAI;YACL,CAHD,MAGO;cACLA,IAAI,CAAC,QAAD,CAAJ;YACD;;UAjCa;YAmChBL,SAAS,CAACmB,IAAV,GAnCgB,CAmCC;;UAnCD;UAAA;YAAA;QAAA;MAAA;IAAA;EAAA,CAAlB;;EAAA;IAAA;EAAA;AAAA,K,CAsCA;;AACArB,MAAM,CAACsB,SAAP,CAAiB,YAAM;EACrBpB,SAAS,CAACmB,IAAV;AACD,CAFD"}]}